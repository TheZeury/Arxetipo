<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Components - Arxetipo User&#x27;s Manual</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../foundations-and-objects.html"><strong aria-hidden="true">1.</strong> Foundations, Systems and Components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../foundations-and-objects/foundation.html"><strong aria-hidden="true">1.1.</strong> Foundations</a></li><li class="chapter-item expanded "><a href="../foundations-and-objects/system.html"><strong aria-hidden="true">1.2.</strong> Systems</a></li><li class="chapter-item expanded "><a href="../foundations-and-objects/component.html" class="active"><strong aria-hidden="true">1.3.</strong> Components</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Foundations</li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> XR Plugin</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Renderer</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Physics Engine</div></li><li class="chapter-item expanded "><a href="../command-runtime.html"><strong aria-hidden="true">5.</strong> Command Runtime</a></li><li class="chapter-item expanded affix "><li class="part-title">Objects</li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> XR</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> XR System</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Graphics</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.1.</strong> Graphics System</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Physics</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> Physics System</div></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../beginner-guide-redirect.html">Beginner Guide</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Arxetipo User&#x27;s Manual</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="components"><a class="header" href="#components">Components</a></h1>
<p>Components are small pieces of game logics that require to be <em>registered</em> to one or more systems to function.</p>
<h2 id="interface"><a class="header" href="#interface">Interface</a></h2>
<p>A type is considered as a component type as long as it has the following member function:</p>
<pre><code class="language-cpp">template&lt;typename Systems&gt;
auto register_to_systems(Systems* systems) -&gt; void;
</code></pre>
<h2 id="register_to_systems"><a class="header" href="#register_to_systems"><code>register_to_systems</code></a></h2>
<p>Example:</p>
<pre><code class="language-cpp">template&lt;typename Systems&gt;
auto register_to_systems(Systems* systems) -&gt; void
{
	if constexpr (systems-&gt;contains&lt;MySystemA&gt;()) {
		auto system_a = systems-&gt;get&lt;MySystemA&gt;();
		// ...
	}

	if constexpr (systems-&gt;contains&lt;MySystemB&gt;()) {
		auto system_b = systems-&gt;get&lt;MySystemB&gt;();
		// ...
	}
}
</code></pre>
<p>You won't get any compiler error if the <code>Systems</code> as a static system componsition doesn't contain the sepicified system or as a concrete system type that is not the specified one, as that can be infered in compile time and will be ignored thanks to <code>if constexpr</code>. 
It's up to you to decide if you want to add <code>requires</code> or <code>static_assert</code>, but it's recommended to leave it as it is.</p>
<p><code>register_to_systems</code> can be called multiple times on different systems, sometimes this way is more convenient than calling it once on a system composition that contains all the systems when if register to a particuar system depends.</p>
<pre><code class="language-cpp">struct MyComponent
{
	template&lt;typename Systems&gt;
	auto register_to_systems(Systems* systems) -&gt; void
	{
		if constexpr (systems-&gt;contains&lt;PhysicsSystem&gt;()) {
			auto system_a = systems-&gt;get&lt;PhysicsSystem&gt;();
			// ...
		}
		if constexpr (systems-&gt;contains&lt;GraphicsSystem&gt;()) {
			auto system_b = systems-&gt;get&lt;GraphicsSystem&gt;();
			// ...
		}
	}

	// ...
};

MyComponent component;

component.register_to_systems(&amp;physics_systems);

if constexpr (visual_debug) {
	component.register_to_systems(&amp;graphics_systems);
}
</code></pre>
<h2 id="working-with-systems"><a class="header" href="#working-with-systems">Working with Systems</a></h2>
<p>Most components can't participate in the game logics on their own without registering to any systems.
You should focus on designing systems and make the systems to organize how components work. 
Therefore, Arxetipo's components by themselves may not have <code>update</code> or <code>on_enable</code> functions, but you can implement such things that are called by systems.</p>
<p>Arxetipo at first may not be intuitive compare to many game engines where learners first add a &quot;thing&quot; called &quot;game object&quot;, &quot;actor&quot; or &quot;entity&quot; to the scene, then add components to form that &quot;thing&quot;.
With Arxetipo, you first design systems, and then design components that work with the systems.
It might be quite abstractive to start with, but it's more compact, flexible and potentially more efficient.</p>
<h2 id="component-composition"><a class="header" href="#component-composition">Component Composition</a></h2>
<p>Just like systems, components can be composed to form a new component.</p>
<p>The <code>register_to_systems</code> function of a component composition will call the <code>register_to_systems</code> function of each component it contains.</p>
<p>By definition, a component composition is still considered as a component, despite it's concept to gather components together may be similar to what an &quot;entity&quot; does in a typical ECS architecture.</p>
<p>There are also two engine-defined composition types: Static Component Composition and Dynamic Component Composition, 
while you always implement something similar to that on your own.</p>
<h3 id="static-component-composition"><a class="header" href="#static-component-composition">Static Component Composition</a></h3>
<pre><code class="language-cpp">template&lt;typename... Types&gt;
struct StaticComponentComposition;
</code></pre>
<h4 id="usage"><a class="header" href="#usage">Usage</a></h4>
<pre><code class="language-cpp">using ModelComponent = StaticComponentComposition&lt;SpaceTransform, MeshModelComponent, RigidDynamicComponent&gt;;

ModelComponent model_component{ /*...*/ };
model_component.register_to_systems(&amp;physics_systems);
model_component.register_to_systems(&amp;graphics_systems);
</code></pre>
<h3 id="dynamic-component-composition"><a class="header" href="#dynamic-component-composition">Dynamic Component Composition</a></h3>
<pre><code class="language-cpp">struct DynamicComponentComposition;
</code></pre>
<h4 id="usage-1"><a class="header" href="#usage-1">Usage</a></h4>
<pre><code class="language-cpp">DynamicComponentComposition model_component;
model_component.add&lt;SpaceTransform&gt;({ /*...*/ });
model_component.add&lt;MeshModelComponent&gt;({ /*...*/ });
model_component.add&lt;RigidStaticComponent&gt;({ /*...*/ });
model_component.remove&lt;RigidStaticComponent&gt;();
model_component.add&lt;RigidDynamicComponent&gt;({ /*...*/ });

if (simulating) {
	model_component.register_to_systems(&amp;physics_systems);
}

if (visual_debug) {
	model_component.register_to_systems(&amp;graphics_systems);
}
else {
	model_component.get&lt;MeshModelComponent&gt;().register_to_systems(&amp;graphics_systems);
	// RigidDynamicComponent is not registered to graphics_systems.
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../foundations-and-objects/system.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../command-runtime.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../foundations-and-objects/system.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../command-runtime.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
