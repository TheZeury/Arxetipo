<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Systems - Arxetipo User&#x27;s Manual</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../foundations-and-objects.html"><strong aria-hidden="true">1.</strong> Foundations, Systems and Components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../foundations-and-objects/foundation.html"><strong aria-hidden="true">1.1.</strong> Foundations</a></li><li class="chapter-item expanded "><a href="../foundations-and-objects/system.html" class="active"><strong aria-hidden="true">1.2.</strong> Systems</a></li><li class="chapter-item expanded "><a href="../foundations-and-objects/component.html"><strong aria-hidden="true">1.3.</strong> Components</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Foundations</li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> XR Plugin</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Renderer</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Physics Engine</div></li><li class="chapter-item expanded "><a href="../command-runtime.html"><strong aria-hidden="true">5.</strong> Command Runtime</a></li><li class="chapter-item expanded affix "><li class="part-title">Objects</li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> XR</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> XR System</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Graphics</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.1.</strong> Graphics System</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Physics</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> Physics System</div></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../beginner-guide-redirect.html">Beginner Guide</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Arxetipo User&#x27;s Manual</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="systems"><a class="header" href="#systems">Systems</a></h1>
<p>Systems are managers of related game logics, and can be based on foundations and other systems. </p>
<h2 id="interfaces-aka-concept"><a class="header" href="#interfaces-aka-concept">Interfaces (aka. Concept)</a></h2>
<p>By convention a system type is a type that implements the following member functions:</p>
<pre><code class="language-cpp">auto mobilize() -&gt; void;
auto freeze() -&gt; void;
auto update() -&gt; void;

template&lt;typename System&gt;
requires /*...*/
auto get() -&gt; System*;

template&lt;typename System&gt;
auto contains() -&gt; bool;
</code></pre>
<p>The <code>get</code> and <code>contains</code> function can be useful when extracting a particular system from a <a href="#system-composition"><strong>System Composition</strong></a>. 
For a single system which you would most likely write, it should be implemented as follows:</p>
<pre><code class="language-cpp">struct MySystem {
	// ... 

	template&lt;typename System&gt;
	requires std::same_as&lt;System, MySystem&gt;
	auto get() noexcept -&gt; System* {
		return this;
	}

	template&lt;typename System&gt;
	constexpr auto contains() -&gt; bool {
		return std::same_as&lt;System, MySystem&gt;;
	}
};
</code></pre>
<h2 id="system-composition"><a class="header" href="#system-composition">System Composition</a></h2>
<p>A system composition is a type that contains a collection of systems. 
It is also a system itself as it implements the same interface as a system. </p>
<p>Arxetipo implements are two kinds of system compositions: <strong>Static System Composition</strong> and <strong>Dynamic System Composition</strong>.</p>
<p>regradless of which kind a system composition is, it behaves as:</p>
<ul>
<li>call the <code>mobilize</code> functions of all systems it contains when <code>mobilize</code> is called.</li>
<li>call the <code>freeze</code> functions of all systems it contains when <code>freeze</code> is called.</li>
<li>call the <code>update</code> functions of all systems it contains when <code>update</code> is called.</li>
<li>return a pointer to the required system when <code>get</code> is called.</li>
</ul>
<p>The most common use case is to pass a System Composition which contains all required systems when registering a component to systems using its member function <code>register_to_systems</code>. 
See more: <a href="component.html#register_to_systems">Component</a>.</p>
<p>On the other hand, <code>mobilize</code>, <code>freeze</code> and <code>update</code> functions of a system composition are not commonly used, as the exact point at which they should be called varies from system to system. 
But they can still be useful when some systems are truely highly associated.</p>
<p>Both static system composition and dynamic system composition excute underlying systems in the order they are added. 
You can write your own system composition in the way you would like it to be.</p>
<h3 id="static-system-composition"><a class="header" href="#static-system-composition">Static System Composition</a></h3>
<pre><code class="language-cpp">template&lt;typename... Types&gt;
struct StaticSystemComposition;
</code></pre>
<p>A static system composition is a system composition which types of systems it contains are known at compile time. 
Removing or adding a new system to a static system after initializion <strong>IS NOT</strong> possible.</p>
<h4 id="usage"><a class="header" href="#usage">Usage</a></h4>
<pre><code class="language-cpp">StaticSystemCompostion&lt;GraphicsSystem, XRSystem, PhysicsSystem&gt; systems{ { }, { }, { } };

RigidDynamicComponent ball{ /*...*/ }; // A component that can be registered to both GraphicsSystem and PhysicsSystem.

ball.register_to_systems(systems);
</code></pre>
<h4 id="get"><a class="header" href="#get"><code>get</code></a></h4>
<pre><code class="language-cpp">template&lt;typename System&gt;
requires (std::same_as&lt;System, Types&gt; || ...)
auto get() noexcept -&gt; System*;
</code></pre>
<p>Any system type that is not contained in the static system composition will cause a compile error.</p>
<p>The exact signature is different from above because of the implementation, but they work the same.</p>
<h4 id="contains"><a class="header" href="#contains"><code>contains</code></a></h4>
<pre><code class="language-cpp">template&lt;typename System&gt;
constexpr auto contains() -&gt; bool {
	return std::same_as&lt;System, Types&gt; || ...;
}
</code></pre>
<p>A constexpr function that is evaluated at compile time.</p>
<h3 id="dynamic-system-composition"><a class="header" href="#dynamic-system-composition">Dynamic System Composition</a></h3>
<pre><code>struct DynamicSystemComposition;
</code></pre>
<p>A dynamic system composition is a system composition which types of systems it contains are known at runtime. 
Removing or adding a new system to a dynamic system after initializion <strong>IS</strong> possible.</p>
<h4 id="usage-1"><a class="header" href="#usage-1">Usage</a></h4>
<pre><code class="language-cpp">DynamicSystemComposition systems;
systems.add&lt;GraphicsSystem&gt;();
systems.add&lt;XRSystem&gt;();
systems.add&lt;PhysicsSystem&gt;();
systems.remove&lt;XRSystem&gt;();

RigidDynamicComponent ball{ /*...*/ }; 

ball.register_to_systems(systems);
</code></pre>
<h4 id="get-1"><a class="header" href="#get-1"><code>get</code></a></h4>
<pre><code class="language-cpp">template&lt;typename System&gt;
auto get() -&gt; System*;
</code></pre>
<p>Any system type that is not contained in the dynamic system composition will cause a runtime error.</p>
<h4 id="contains-1"><a class="header" href="#contains-1"><code>contains</code></a></h4>
<pre><code class="language-cpp">template&lt;typename System&gt;
auto contains() -&gt; bool;
</code></pre>
<p>Return if it contains a system at runtime.</p>
<h3 id="compare-of-staticsystemcompositon-and-dynamicsystemcomposition"><a class="header" href="#compare-of-staticsystemcompositon-and-dynamicsystemcomposition">Compare of <code>StaticSystemCompositon</code> and <code>DynamicSystemComposition</code></a></h3>
<div class="table-wrapper"><table><thead><tr><th>Properties</th><th>StaticSystemComposition</th><th>DynamicSystemComposition</th></tr></thead><tbody>
<tr><td>Memory</td><td>On stack</td><td>On heap</td></tr>
<tr><td>Add System</td><td>Not allowed</td><td>Allowed</td></tr>
<tr><td>Remove System</td><td>Not allowed</td><td>Allowed</td></tr>
<tr><td><code>get</code> type check</td><td>Compile time</td><td>Runtime</td></tr>
<tr><td><code>get</code> noexcept</td><td>True</td><td>False</td></tr>
<tr><td>constexpr <code>contains</code></td><td>True</td><td>False</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../foundations-and-objects/foundation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../foundations-and-objects/component.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../foundations-and-objects/foundation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../foundations-and-objects/component.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
